# Examples

Here is the generated code to the examples in [README.md](../README.md).

## Example (non-versioned)

Note Markdown insists on creating its own indentation format for this particular code block, which is why it's a bit messed up.

```kotlin
// Generated by KReplica. Do not edit.
@file:OptIn(ExperimentalUuidApi::class)

package io.availe.demo

import io.availe.models.Patchable
        import kotlin.OptIn
        import kotlin.String
        import kotlin.collections.List
        import kotlin.jvm.JvmInline
        import kotlin.uuid.ExperimentalUuidApi
        import kotlin.uuid.Uuid

        /**
         * A sealed hierarchy representing all variants of the UserAccount data model.
         */
        public sealed interface UserAccountSchema {
    public data class Data(
        public val emailAddress: UserAccountEmailAddress,
        public val id: UserAccountId,
        public val banReason: UserAccountBanReason,
        public val userDescription: String?,
    ) : UserAccountSchema

    public data class CreateRequest(
        public val emailAddress: UserAccountEmailAddress,
        public val userDescription: String?,
    ) : UserAccountSchema

    public data class PatchRequest(
        public val emailAddress: Patchable<UserAccountEmailAddress> = Patchable.Unchanged,
        public val banReason: Patchable<UserAccountBanReason> = Patchable.Unchanged,
        public val userDescription: Patchable<String?> = Patchable.Unchanged,
    ) : UserAccountSchema
}

/**
 * VALUE CLASSES
 */
@JvmInline
public value class UserAccountBanReason(
    public val `value`: Patchable<List<String?>>,
)

@JvmInline
public value class UserAccountEmailAddress(
    public val `value`: String,
)

@JvmInline
public value class UserAccountId(
    public val `value`: Uuid,
)
```

## Patchable

```kotlin
package io.availe.models

import kotlinx.serialization.Serializable

/**
 * Used by generated PATCH request code to mark fields as updated or unchanged.
 * Use Set(value) to update a field, or Unchanged to leave it as-is.
 */
sealed class Patchable<out T> {
    data class Set<out T>(val value: T) : Patchable<T>()
    data object Unchanged : Patchable<Nothing>()
}

/**
 * Used by generated serializable PATCH request code to mark fields as updated or unchanged.
 * Use Set(value) to update a field, or Unchanged to leave it as-is.
 */
@Serializable
sealed class SerializablePatchable<out T> {
    @Serializable
    data class Set<out T>(val value: T) : SerializablePatchable<T>()

    @Serializable
    data object Unchanged : SerializablePatchable<Nothing>()
}
```

## Example (versioned)

```kotlin
// Generated by KReplica. Do not edit.
package io.availe.demo

import io.availe.models.Patchable
import kotlin.Int
import kotlin.String

/**
 * A sealed class hierarchy representing all versions of the UserAccount data model.
 */
public sealed interface UserAccountSchema {
    public sealed interface DataVariant : UserAccountSchema

    public sealed interface PatchRequestVariant : UserAccountSchema

    /**
     * --------------------------
     * |   Version 1 (V1)   |
     * --------------------------
     */
    public sealed interface V1 : UserAccountSchema {
        public data class Data(
            public val id: Int,
            public val schemaVersion: Int = 1,
        ) : V1,
            DataVariant
    }

    /**
     * --------------------------
     * |   Version 2 (V2)   |
     * --------------------------
     */
    public sealed interface V2 : UserAccountSchema {
        public data class Data(
            public val id: Int,
            public val name: String,
            public val schemaVersion: Int = 2,
        ) : V2,
            DataVariant

        public data class PatchRequest(
            public val id: Patchable<Int> = Patchable.Unchanged,
            public val name: Patchable<String> = Patchable.Unchanged,
            public val schemaVersion: Patchable<Int> = Patchable.Unchanged,
        ) : V2,
            PatchRequestVariant
    }
}
```

## Example (versioned w/ schema version annotation)

```kotlin
// Generated by KReplica. Do not edit.
package io.availe.demo

import io.availe.models.Patchable
import kotlin.Int
import kotlin.String

/**
 * A sealed class hierarchy representing all versions of the UserAccount data model.
 */
public sealed interface UserAccountSchema {
  public sealed interface DataVariant : UserAccountSchema

  public sealed interface PatchRequestVariant : UserAccountSchema

  /**
   * --------------------------
   * |   Version 1 (NewAccount)   |
   * --------------------------
   */
  public sealed interface NewAccount : UserAccountSchema {
    public data class Data(
      public val id: Int,
      public val name: String,
      public val schemaVersion: Int = 1,
    ) : NewAccount,
        DataVariant

    public data class PatchRequest(
      public val id: Patchable<Int> = Patchable.Unchanged,
      public val name: Patchable<String> = Patchable.Unchanged,
      public val schemaVersion: Patchable<Int> = Patchable.Unchanged,
    ) : NewAccount,
        PatchRequestVariant
  }
}
```

## Example (serializable)

Again, markdown messes with the indentation in this example:

```kotlin
// Generated by KReplica. Do not edit.
@file:OptIn(ExperimentalTime::class)

package io.availe

import kotlin.Int
        import kotlin.OptIn
        import kotlin.collections.List
        import kotlin.time.ExperimentalTime
        import kotlin.time.Instant
        import kotlinx.serialization.Contextual
        import kotlinx.serialization.Serializable

        /**
         * A sealed interface hierarchy representing all versions of the UserAccount data model.
         */
        @Serializable
        public sealed interface UserAccountSchema {
            public sealed interface DataVariant : UserAccountSchema

            /**
             * --------------------------
             * |   Version 1 (V1)   |
             * --------------------------
             */
            @Serializable
            public sealed interface V1 : UserAccountSchema {
                @Serializable
                public data class Data(
                    public val id: Int,
                    @Contextual
                    public val startTime: Instant,
                    @Serializable(with = io.availe.InstantAsStringSerializer::class)
                    public val midTime: Instant,
                    public val endTime: List<List<@Contextual Instant>>,
                    public val schemaVersion: Int = 1,
                ) : V1,
                    DataVariant
            }
        }
```

## Directly applying annotations

```kotlin
// Generated by KReplica. Do not edit.
package io.availe.demo

import kotlin.Deprecated
import kotlin.Int
import kotlin.ReplaceWith

/**
 * A sealed hierarchy representing all variants of the UserAccount data model.
 */
@Deprecated(
    message = "Use NewUserAccount instead",
    replaceWith = ReplaceWith(expression = "", imports = []),
    level = DeprecationLevel.WARNING,
)
public sealed interface UserAccountSchema {
    @Deprecated(
        message = "Use NewUserAccount instead",
        replaceWith = ReplaceWith(expression = "", imports = []),
        level = DeprecationLevel.WARNING,
    )
    public data class Data(
        @Deprecated(
            message = "Use newId instead",
            replaceWith = ReplaceWith(expression = "", imports = []),
            level = DeprecationLevel.WARNING,
        )
        public val id: Int,
    ) : UserAccountSchema
}
```

## Contextual nested model (versioned)

```kotlin
// Generated by KReplica. Do not edit.
package io.availe.demo

import io.availe.models.Patchable

/**
 * A sealed hierarchy representing all variants of the AdminAccount data model.
 */
public sealed interface AdminAccountSchema {
    public data class Data(
        public val user: UserAccountSchema.V1.Data,
    ) : AdminAccountSchema

    public data class CreateRequest(
        public val user: UserAccountSchema.V1.CreateRequest,
    ) : AdminAccountSchema

    public data class PatchRequest(
        public val user: Patchable<UserAccountSchema.V1.PatchRequest> = Patchable.Unchanged,
    ) : AdminAccountSchema
}
```

## Contextual nested model (non-versioned)

```kotlin
// Generated by KReplica. Do not edit.
package io.availe.demo

import io.availe.models.Patchable

/**
 * A sealed hierarchy representing all variants of the AdminAccount data model.
 */
public sealed interface AdminAccountSchema {
    public data class Data(
        public val user: UserAccountSchema.Data,
    ) : AdminAccountSchema

    public data class CreateRequest(
        public val user: UserAccountSchema.CreateRequest,
    ) : AdminAccountSchema

    public data class PatchRequest(
        public val user: Patchable<UserAccountSchema.PatchRequest> = Patchable.Unchanged,
    ) : AdminAccountSchema
}
```